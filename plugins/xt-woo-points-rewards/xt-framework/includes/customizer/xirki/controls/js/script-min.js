if(_.isUndefined(window.xirkiSetSettingValue)){var xirkiSetSettingValue={set:function(setting,value){var $this=this,subControl=wp.customize.settings.controls[setting],valueJSON;if(_.isUndefined(subControl)){return true}$this.setValue(setting,value);switch(subControl.type){case"xirki-background":if(!_.isUndefined(value["background-color"])){$this.setColorPicker($this.findElement(setting,".xirki-color-control"),value["background-color"])}$this.findElement(setting,".placeholder, .thumbnail").removeClass().addClass("placeholder").html("No file selected");_.each(["background-repeat","background-position"],function(subVal){if(!_.isUndefined(value[subVal])){$this.setSelectWoo($this.findElement(setting,"."+subVal+" select"),value[subVal])}});_.each(["background-size","background-attachment"],function(subVal){jQuery($this.findElement(setting,"."+subVal+' input[value="'+value+'"]')).prop("checked",true)});valueJSON=JSON.stringify(value).replace(/'/g,"&#39");jQuery($this.findElement(setting,".background-hidden-value").attr("value",valueJSON)).trigger("change");break;case"xirki-code":jQuery($this.findElement(setting,".CodeMirror"))[0].CodeMirror.setValue(value);break;case"checkbox":case"xirki-switch":case"xirki-toggle":value=1===value||"1"===value||true===value?true:false;jQuery($this.findElement(setting,"input")).prop("checked",value);wp.customize.instance(setting).set(value);break;case"xirki-select":$this.setSelectWoo($this.findElement(setting,"select"),value);break;case"xirki-slider":jQuery($this.findElement(setting,"input")).prop("value",value);jQuery($this.findElement(setting,".xirki_range_value .value")).html(value);break;case"xirki-generic":if(_.isUndefined(subControl.choices)||_.isUndefined(subControl.choices.element)){subControl.choices.element="input"}jQuery($this.findElement(setting,subControl.choices.element)).prop("value",value);break;case"xirki-color":$this.setColorPicker($this.findElement(setting,".xirki-color-control"),value);break;case"xirki-multicheck":$this.findElement(setting,"input").each(function(){jQuery(this).prop("checked",false)});_.each(value,function(subValue,i){jQuery($this.findElement(setting,'input[value="'+value[i]+'"]')).prop("checked",true)});break;case"xirki-multicolor":_.each(value,function(subVal,index){$this.setColorPicker($this.findElement(setting,".multicolor-index-"+index),subVal)});break;case"xirki-radio-buttonset":case"xirki-radio-image":case"xirki-radio":case"xirki-dashicons":case"xirki-color-palette":case"xirki-palette":jQuery($this.findElement(setting,'input[value="'+value+'"]')).prop("checked",true);break;case"xirki-typography":_.each(["font-family","variant"],function(subVal){if(!_.isUndefined(value[subVal])){$this.setSelectWoo($this.findElement(setting,"."+subVal+" select"),value[subVal])}});_.each(["font-size","line-height","letter-spacing","word-spacing"],function(subVal){if(!_.isUndefined(value[subVal])){jQuery($this.findElement(setting,"."+subVal+" input")).prop("value",value[subVal])}});if(!_.isUndefined(value.color)){$this.setColorPicker($this.findElement(setting,".xirki-color-control"),value.color)}valueJSON=JSON.stringify(value).replace(/'/g,"&#39");jQuery($this.findElement(setting,".typography-hidden-value").attr("value",valueJSON)).trigger("change");break;case"xirki-dimensions":_.each(value,function(subValue,id){jQuery($this.findElement(setting,"."+id+" input")).prop("value",subValue)});break;case"xirki-repeater":break;case"xirki-custom":break;default:jQuery($this.findElement(setting,"input")).prop("value",value)}},setColorPicker:function(selector,value){selector.attr("data-default-color",value).data("default-color",value).wpColorPicker("color",value)},setSelectWoo:function(selector,value){jQuery(selector).selectWoo().val(value).trigger("change")},setTextarea:function(selector,value){jQuery(selector).prop("value",value)},findElement:function(setting,element){return wp.customize.control(setting).container.find(element)},setValue:function(setting,value,timeout){timeout=_.isUndefined(timeout)?100:parseInt(timeout,10);wp.customize.instance(setting).set({});setTimeout(function(){wp.customize.instance(setting).set(value)},timeout)}}}var xirki={initialized:false,initialize:function(){var self=this;if(self.initialized){return}setTimeout(function(){xirki.util.webfonts.standard.initialize();xirki.util.webfonts.google.initialize()},150);self.initialized=true}};xirki.initialize();var xirki=xirki||{};xirki=jQuery.extend(xirki,{control:{"xirki-radio":{init:function(control){var self=this;self.template(control);xirki.input.radio.init(control)},template:function(control){var template=wp.template("xirki-input-radio");control.container.html(template({label:control.params.label,description:control.params.description,"data-id":control.id,inputAttrs:control.params.inputAttrs,default:control.params.default,value:xirki.setting.get(control.id),choices:control.params.choices}))}},"xirki-color":{init:function(control){var self=this;self.template(control);xirki.input.color.init(control)},template:function(control){var template=wp.template("xirki-input-color");control.container.html(template({label:control.params.label,description:control.params.description,"data-id":control.id,mode:control.params.mode,inputAttrs:control.params.inputAttrs,"data-palette":control.params.palette,"data-default-color":control.params.default,"data-alpha":control.params.choices.alpha,value:xirki.setting.get(control.id)}))}},"xirki-generic":{init:function(control){var self=this;self.template(control);if(!_.isUndefined(control.params)&&!_.isUndefined(control.params.choices)&&!_.isUndefined(control.params.choices.element)&&"textarea"===control.params.choices.element){xirki.input.textarea.init(control);return}xirki.input.genericInput.init(control)},template:function(control){var args={label:control.params.label,description:control.params.description,"data-id":control.id,inputAttrs:control.params.inputAttrs,choices:control.params.choices,value:xirki.setting.get(control.id)},template;if(!_.isUndefined(control.params)&&!_.isUndefined(control.params.choices)&&!_.isUndefined(control.params.choices.element)&&"textarea"===control.params.choices.element){template=wp.template("xirki-input-textarea");control.container.html(template(args));return}template=wp.template("xirki-input-generic");control.container.html(template(args))}},"xirki-number":{init:function(control){var self=this;self.template(control);xirki.input.number.init(control)},template:function(control){var template=wp.template("xirki-input-number");control.container.html(template(args={label:control.params.label,description:control.params.description,"data-id":control.id,inputAttrs:control.params.inputAttrs,choices:control.params.choices,value:xirki.setting.get(control.id)}))}},"xirki-image":{init:function(control){var self=this;self.template(control);xirki.input.image.init(control)},template:function(control){var template=wp.template("xirki-input-image");control.container.html(template(args={label:control.params.label,description:control.params.description,"data-id":control.id,inputAttrs:control.params.inputAttrs,choices:control.params.choices,value:xirki.setting.get(control.id)}))}},"xirki-select":{init:function(control){var self=this;self.template(control);xirki.input.select.init(control)},template:function(control){var template=wp.template("xirki-input-select");control.container.html(template({label:control.params.label,description:control.params.description,"data-id":control.id,inputAttrs:control.params.inputAttrs,choices:control.params.choices,value:xirki.setting.get(control.id),multiple:control.params.multiple||1,placeholder:control.params.placeholder}))}}}});var xirki=xirki||{};xirki=jQuery.extend(xirki,{input:{radio:{init:function(control){var input=jQuery('input[data-id="'+control.id+'"]');input.on("change keyup paste click",function(){xirki.setting.set(control.id,jQuery(this).val())})}},color:{init:function(control){var picker=jQuery('.xirki-color-control[data-id="'+control.id+'"]'),clear;control.choices=control.choices||{};if(_.isEmpty(control.choices)&&control.params.choices){control.choices=control.params.choices}if(!_.isEmpty(control.choices)){picker.wpColorPicker(control.choices)}setTimeout(function(){clear=jQuery('.xirki-input-container[data-id="'+control.id+'"] .wp-picker-clear');if(clear.length){clear.click(function(){xirki.setting.set(control.id,"")})}},200);picker.wpColorPicker({change:function(){setTimeout(function(){xirki.setting.set(control.id,picker.val())},20)}})}},genericInput:{init:function(control){var input=jQuery('input[data-id="'+control.id+'"]');input.on("change keyup paste click",function(){xirki.setting.set(control.id,jQuery(this).val())})}},textarea:{init:function(control){var textarea=jQuery('textarea[data-id="'+control.id+'"]');textarea.on("change keyup paste click",function(){xirki.setting.set(control.id,jQuery(this).val())})}},select:{init:function(control){var element=jQuery('select[data-id="'+control.id+'"]'),multiple=parseInt(element.data("multiple"),10),selectValue,selectWooOptions={escapeMarkup:function(markup){return markup}};if(control.params.placeholder){selectWooOptions.placeholder=control.params.placeholder;selectWooOptions.allowClear=true}if(1<multiple){selectWooOptions.maximumSelectionLength=multiple}jQuery(element).selectWoo(selectWooOptions).on("change",function(){selectValue=jQuery(this).val();selectValue=null===selectValue&&1<multiple?[]:selectValue;xirki.setting.set(control.id,selectValue)})}},number:{init:function(control){var element=jQuery('input[data-id="'+control.id+'"]'),value=control.setting._value,up,down;control.params.choices=_.defaults(control.params.choices,{min:0,max:100,step:1});if(isNaN(value)||""===value){value=0>control.params.choices.min&&0<control.params.choices.max?0:control.params.choices.min}value=parseFloat(value);control.params.choices.step="any"===control.params.choices.step?.001:control.params.choices.step;control.params.choices.min=parseFloat(control.params.choices.min);control.params.choices.max=parseFloat(control.params.choices.max);control.params.choices.step=parseFloat(control.params.choices.step);up=jQuery('.xirki-input-container[data-id="'+control.id+'"] .plus');down=jQuery('.xirki-input-container[data-id="'+control.id+'"] .minus');up.click(function(){var oldVal=parseFloat(element.val()),newVal;newVal=oldVal>=control.params.choices.max?oldVal:oldVal+control.params.choices.step;element.val(newVal);element.trigger("change")});down.click(function(){var oldVal=parseFloat(element.val()),newVal;newVal=oldVal<=control.params.choices.min?oldVal:oldVal-control.params.choices.step;element.val(newVal);element.trigger("change")});element.on("change keyup paste click",function(){var val=jQuery(this).val();if(isNaN(val)){val=parseFloat(val,10);val=isNaN(val)?0:val;jQuery(this).attr("value",val)}xirki.setting.set(control.id,val)})}},image:{init:function(control){var value=xirki.setting.get(control.id),saveAs=!_.isUndefined(control.params.choices)&&!_.isUndefined(control.params.choices.save_as)?control.params.choices.save_as:"url",preview=control.container.find(".placeholder, .thumbnail"),previewImage="array"===saveAs?value.url:value,removeButton=control.container.find(".image-upload-remove-button"),defaultButton=control.container.find(".image-default-button");value="array"===saveAs&&_.isString(value)?{url:value}:value;if(("id"===saveAs||"ID"===saveAs)&&""!==value){wp.media.attachment(value).fetch().then(function(){setTimeout(function(){var url=wp.media.attachment(value).get("url");preview.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+url+'" alt="" />')},700)})}if("url"===saveAs&&""!==value||"array"===saveAs&&!_.isUndefined(value.url)&&""!==value.url){control.container.find("image-default-button").hide()}if("url"===saveAs&&""===value||"array"===saveAs&&(_.isUndefined(value.url)||""===value.url)){removeButton.hide()}if(value===control.params.default){control.container.find("image-default-button").hide()}if(""!==previewImage){preview.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+previewImage+'" alt="" />')}control.container.on("click",".image-upload-button",function(e){var image=wp.media({multiple:false}).open().on("select",function(){var uploadedImage=image.state().get("selection").first(),jsonImg=uploadedImage.toJSON(),previewImage=jsonImg.url;if(!_.isUndefined(jsonImg.sizes)){previewImage=jsonImg.sizes.full.url;if(!_.isUndefined(jsonImg.sizes.medium)){previewImage=jsonImg.sizes.medium.url}else if(!_.isUndefined(jsonImg.sizes.thumbnail)){previewImage=jsonImg.sizes.thumbnail.url}}if("array"===saveAs){xirki.setting.set(control.id,{id:jsonImg.id,url:jsonImg.sizes.full.url,width:jsonImg.width,height:jsonImg.height})}else if("id"===saveAs){xirki.setting.set(control.id,jsonImg.id)}else{xirki.setting.set(control.id,!_.isUndefined(jsonImg.sizes)?jsonImg.sizes.full.url:jsonImg.url)}if(preview.length){preview.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+previewImage+'" alt="" />')}if(removeButton.length){removeButton.show();defaultButton.hide()}});e.preventDefault()});control.container.on("click",".image-upload-remove-button",function(e){var preview,removeButton,defaultButton;e.preventDefault();xirki.setting.set(control.id,"");preview=control.container.find(".placeholder, .thumbnail");removeButton=control.container.find(".image-upload-remove-button");defaultButton=control.container.find(".image-default-button");if(preview.length){preview.removeClass().addClass("placeholder").html(xirkiL10n.noFileSelected)}if(removeButton.length){removeButton.hide();if(jQuery(defaultButton).hasClass("button")){defaultButton.show()}}});control.container.on("click",".image-default-button",function(e){var preview,removeButton,defaultButton;e.preventDefault();xirki.setting.set(control.id,control.params.default);preview=control.container.find(".placeholder, .thumbnail");removeButton=control.container.find(".image-upload-remove-button");defaultButton=control.container.find(".image-default-button");if(preview.length){preview.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+control.params.default+'" alt="" />')}if(removeButton.length){removeButton.show();defaultButton.hide()}})}}}});var xirki=xirki||{};xirki=jQuery.extend(xirki,{setting:{get:function(setting){var parts=setting.split("["),foundSetting="",foundInStep=0,currentVal="";_.each(parts,function(part,i){part=part.replace("]","");if(0===i){foundSetting=part}else{foundSetting+="["+part+"]"}if(!_.isUndefined(wp.customize.instance(foundSetting))){currentVal=wp.customize.instance(foundSetting).get();foundInStep=i}if(foundInStep<i){if(_.isObject(currentVal)&&!_.isUndefined(currentVal[part])){currentVal=currentVal[part]}}});return currentVal},set:function(element,value,key){var setting,parts,currentNode="",foundNode="",subSettingObj={},currentVal,subSetting,subSettingParts;setting=element;if(_.isObject(element)){if(jQuery(element).attr("data-id")){setting=element.attr("data-id")}else{setting=element.parents("[data-id]").attr("data-id")}}if("undefined"!==typeof wp.customize.control(setting)){wp.customize.control(setting).setting.set(value);return}parts=setting.split("[");_.each(parts,function(part,i){part=part.replace("]","");currentNode=0===i?part:"["+part+"]";if(!_.isUndefined(wp.customize.instance(currentNode))){foundNode=currentNode;currentVal=wp.customize.instance(foundNode).get()}});subSetting=setting.replace(foundNode,"");if(""!==subSetting){if(!_.isObject(currentVal)){currentVal={}}if("["===subSetting.charAt(0)){subSetting=subSetting.replace("[","")}subSettingParts=subSetting.split("[");_.each(subSettingParts,function(subSettingPart,i){subSettingParts[i]=subSettingPart.replace("]","")});if(key){subSettingParts.push(key)}subSettingObj='{"'+subSettingParts.join('":{"')+'":"'+value+'"'+"}".repeat(subSettingParts.length);subSettingObj=JSON.parse(subSettingObj);jQuery.extend(true,currentVal,subSettingObj);value=currentVal}else{if(key){currentVal=!_.isObject(currentVal)?{}:currentVal;currentVal[key]=value;value=currentVal}}wp.customize.control(foundNode).setting.set(value)}}});var xirki=xirki||{};xirki=jQuery.extend(xirki,{util:{webfonts:{google:{fonts:{},initialize:function(){var self=this;self.setFonts()},setFonts:function(){var self=this;if(!_.isEmpty(self.fonts)){return}jQuery.post(ajaxurl,{action:"xirki_fonts_google_all_get"},function(response){self.fonts=JSON.parse(response)})},getFont:function(family){var self=this,fonts=self.getFonts();if("undefined"===typeof fonts[family]){return false}return fonts[family]},getFonts:function(order,category,number){var self=this,ordered={},categorized={},plucked={};order=order||"alpha";order="alpha"!==order&&"popularity"!==order&&"trending"!==order?"alpha":order;number=number||0;number=parseInt(number,10);if("alpha"===order){ordered=jQuery.extend({},self.fonts.items)}else{_.each(self.fonts.order[order],function(family){ordered[family]=self.fonts.items[family]})}if(""===category||!category){categorized=ordered}else{_.each(ordered,function(font,family){if(category===font.category){categorized[family]=font}})}if(0<number){_.each(_.first(_.keys(categorized),number),function(family){plucked[family]=categorized[family]});return plucked}return categorized},getVariants:function(family){var self=this,font=self.getFont(family);if(!font){return false}if(_.isUndefined(font.variants)){return false}return font.variants}},standard:{fonts:{},initialize:function(){var self=this;self.setFonts()},setFonts:function(){var self=this;if(!_.isEmpty(self.fonts)){return}jQuery.post(ajaxurl,{action:"xirki_fonts_standard_all_get"},function(response){self.fonts=JSON.parse(response)})},getVariants:function(){return["regular","italic","700","700italic"]}},getFontType:function(family){var self=this;if("undefined"!==typeof self.standard.fonts[family]||"undefined"!==typeof self.standard.fonts.stack&&"undefined"!==typeof self.standard.fonts.stack[family]){return"standard"}if("undefined"!==typeof self.google.fonts.items&&"undefined"!==typeof self.google.fonts.items[family]){return"google"}return false}},validate:{cssValue:function(value){var validUnits=["fr","rem","em","ex","%","px","cm","mm","in","pt","pc","ch","vh","vw","vmin","vmax"],numericValue,unit;if("string"!==typeof value||"number"!==typeof value){return true}if(0===value||"0"===value||"auto"===value||"inherit"===value||"initial"===value){return true}if(0<=value.indexOf("calc(")&&0<=value.indexOf(")")){return true}numericValue=parseFloat(value);unit=value.replace(numericValue,"");if(!value){return}return!isNaN(numericValue)&&-1<jQuery.inArray(unit,validUnits)}},parseHtmlEntities:function(str){var parser=new DOMParser,dom=parser.parseFromString("<!doctype html><body>"+str,"text/html");return dom.body.textContent}}});(function(){"use strict";wp.customize.xirkiDynamicControl=wp.customize.Control.extend({initialize:function(id,options){var control=this,args=options||{};args.params=args.params||{};if(!args.params.type){args.params.type="xirki-generic"}if(!args.params.content){args.params.content=jQuery("<li></li>");args.params.content.attr("id","customize-control-"+id.replace(/]/g,"").replace(/\[/g,"-"));args.params.content.attr("class","customize-control customize-control-"+args.params.type)}control.propertyElements=[];wp.customize.Control.prototype.initialize.call(control,id,args)},_setUpSettingRootLinks:function(){var control=this,nodes=control.container.find("[data-customize-setting-link]");nodes.each(function(){var node=jQuery(this);wp.customize(node.data("customizeSettingLink"),function(setting){var element=new wp.customize.Element(node);control.elements.push(element);element.sync(setting);element.set(setting())})})},_setUpSettingPropertyLinks:function(){var control=this,nodes;if(!control.setting){return}nodes=control.container.find("[data-customize-setting-property-link]");nodes.each(function(){var node=jQuery(this),element,propertyName=node.data("customizeSettingPropertyLink");element=new wp.customize.Element(node);control.propertyElements.push(element);element.set(control.setting()[propertyName]);element.bind(function(newPropertyValue){var newSetting=control.setting();if(newPropertyValue===newSetting[propertyName]){return}newSetting=_.clone(newSetting);newSetting[propertyName]=newPropertyValue;control.setting.set(newSetting)});control.setting.bind(function(newValue){if(newValue[propertyName]!==element.get()){element.set(newValue[propertyName])}})})},ready:function(){var control=this;control._setUpSettingRootLinks();control._setUpSettingPropertyLinks();wp.customize.Control.prototype.ready.call(control);control.deferred.embedded.done(function(){control.initXirkiControl(control)})},embed:function(){var control=this,sectionId=control.section();if(!sectionId){return}wp.customize.section(sectionId,function(section){if("xirki-expanded"===section.params.type||section.expanded()||wp.customize.settings.autofocus.control===control.id){control.actuallyEmbed()}else{section.expanded.bind(function(expanded){if(expanded){control.actuallyEmbed()}})}})},actuallyEmbed:function(){var control=this;if("resolved"===control.deferred.embedded.state()){return}control.renderContent();control.deferred.embedded.resolve()},focus:function(args){var control=this;control.actuallyEmbed();wp.customize.Control.prototype.focus.call(control,args)},initXirkiControl:function(control){if("undefined"!==typeof xirki.control[control.params.type]){xirki.control[control.params.type].init(control);return}this.container.on("change keyup paste click","input",function(){control.setting.set(jQuery(this).val())})}})})();_.each(xirki.control,function(obj,type){wp.customize.controlConstructor[type]=wp.customize.xirkiDynamicControl.extend({})});wp.customize.controlConstructor["xirki-background"]=wp.customize.Control.extend({ready:function(){"use strict";var control=this;if(!_.isUndefined(window.xirkiControlLoader)&&_.isFunction(xirkiControlLoader)){xirkiControlLoader(control)}else{control.initXirkiControl()}},initXirkiControl:function(){var control=this,value=control.setting._value,picker=control.container.find(".xirki-color-control");if(_.isUndefined(value["background-image"])||""===value["background-image"]){control.container.find(".background-wrapper > .background-repeat").hide();control.container.find(".background-wrapper > .background-position").hide();control.container.find(".background-wrapper > .background-size").hide();control.container.find(".background-wrapper > .background-attachment").hide()}picker.wpColorPicker({change:function(){setTimeout(function(){control.saveValue("background-color",picker.val())},100)},clear:function(event){setTimeout(function(){control.saveValue("color","")},100)}});control.container.on("change",".background-repeat select",function(){control.saveValue("background-repeat",jQuery(this).val())});control.container.on("change click",".background-size input",function(){control.saveValue("background-size",jQuery(this).val())});control.container.on("change",".background-position select",function(){control.saveValue("background-position",jQuery(this).val())});control.container.on("change click",".background-attachment input",function(){control.saveValue("background-attachment",jQuery(this).val())});control.container.on("click",".background-image-upload-button",function(e){var image=wp.media({multiple:false}).open().on("select",function(){var uploadedImage=image.state().get("selection").first(),previewImage=uploadedImage.toJSON().sizes.full.url,imageUrl,imageID,imageWidth,imageHeight,preview,removeButton;if(!_.isUndefined(uploadedImage.toJSON().sizes.medium)){previewImage=uploadedImage.toJSON().sizes.medium.url}else if(!_.isUndefined(uploadedImage.toJSON().sizes.thumbnail)){previewImage=uploadedImage.toJSON().sizes.thumbnail.url}imageUrl=uploadedImage.toJSON().sizes.full.url;imageID=uploadedImage.toJSON().id;imageWidth=uploadedImage.toJSON().width;imageHeight=uploadedImage.toJSON().height;if(""!==imageUrl){control.container.find(".background-wrapper > .background-repeat, .background-wrapper > .background-position, .background-wrapper > .background-size, .background-wrapper > .background-attachment").show()}control.saveValue("background-image",imageUrl);preview=control.container.find(".placeholder, .thumbnail");removeButton=control.container.find(".background-image-upload-remove-button");if(preview.length){preview.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+previewImage+'" alt="" />')}if(removeButton.length){removeButton.show()}});e.preventDefault()});control.container.on("click",".background-image-upload-remove-button",function(e){var preview,removeButton;e.preventDefault();control.saveValue("background-image","");preview=control.container.find(".placeholder, .thumbnail");removeButton=control.container.find(".background-image-upload-remove-button");control.container.find(".background-wrapper > .background-repeat").hide();control.container.find(".background-wrapper > .background-position").hide();control.container.find(".background-wrapper > .background-size").hide();control.container.find(".background-wrapper > .background-attachment").hide();if(preview.length){preview.removeClass().addClass("placeholder").html("No file selected")}if(removeButton.length){removeButton.hide()}})},saveValue:function(property,value){var control=this,input=jQuery("#customize-control-"+control.id.replace("[","-").replace("]","")+" .background-hidden-value"),val=control.setting._value;val[property]=value;jQuery(input).attr("value",JSON.stringify(val)).trigger("change");control.setting.set(val)}});wp.customize.controlConstructor["xirki-color-palette"]=wp.customize.xirkiDynamicControl.extend({});wp.customize.controlConstructor["xirki-dashicons"]=wp.customize.xirkiDynamicControl.extend({});wp.customize.controlConstructor["xirki-date"]=wp.customize.xirkiDynamicControl.extend({initXirkiControl:function(){var control=this,selector=control.selector+" input.datepicker";jQuery(selector).datepicker({dateFormat:"yy-mm-dd"});this.container.on("change keyup paste","input.datepicker",function(){control.setting.set(jQuery(this).val())})}});wp.customize.controlConstructor["xirki-dimension"]=wp.customize.xirkiDynamicControl.extend({initXirkiControl:function(){var control=this,value;control.xirkiNotifications();this.container.on("change keyup paste","input",function(){value=jQuery(this).val();control.setting.set(value)})},xirkiNotifications:function(){var control=this,acceptUnitless="undefined"!==typeof control.params.choices&&"undefined"!==typeof control.params.choices.accept_unitless&&true===control.params.choices.accept_unitless;wp.customize(control.id,function(setting){setting.bind(function(value){var code="long_title";if(false===xirki.util.validate.cssValue(value)&&(!acceptUnitless||isNaN(value))){setting.notifications.add(code,new wp.customize.Notification(code,{type:"warning",message:dimensionxirkiL10n["invalid-value"]}))}else{setting.notifications.remove(code)}})})}});wp.customize.controlConstructor["xirki-dimensions"]=wp.customize.xirkiDynamicControl.extend({initXirkiControl:function(){var control=this,subControls=control.params.choices.controls,value={},subsArray=[],i;_.each(subControls,function(v,i){if(true===v){subsArray.push(i)}});for(i=0;i<subsArray.length;i++){value[subsArray[i]]=control.setting._value[subsArray[i]];control.updateDimensionsValue(subsArray[i],value)}},updateDimensionsValue:function(context,value){var control=this;control.container.on("change keyup paste","."+context+" input",function(){value[context]=jQuery(this).val();control.xirkiNotifications();control.saveValue(value)})},saveValue:function(value){var control=this,newValue={};_.each(value,function(newSubValue,i){newValue[i]=newSubValue});control.setting.set(newValue)},xirkiNotifications:function(){var control=this;wp.customize(control.id,function(setting){setting.bind(function(value){var code="long_title",subs={},message;setting.notifications.remove(code);_.each(value,function(val,direction){if(false===xirki.util.validate.cssValue(val)){subs[direction]=val}else{delete subs[direction]}});if(!_.isEmpty(subs)){message=dimensionsxirkiL10n["invalid-value"]+" ("+_.values(subs).toString()+") ";setting.notifications.add(code,new wp.customize.Notification(code,{type:"warning",message:message}));return}setting.notifications.remove(code)})})}});wp.customize.controlConstructor["xirki-editor"]=wp.customize.xirkiDynamicControl.extend({initXirkiControl:function(){var control=this,element=control.container.find("textarea"),id="xirki-editor-"+control.id.replace("[","").replace("]",""),editor;if(wp.editor&&wp.editor.initialize){wp.editor.initialize(id,{tinymce:{wpautop:true},quicktags:true,mediaButtons:true})}editor=tinyMCE.get(id);if(editor){editor.onChange.add(function(ed){var content;ed.save();content=editor.getContent();element.val(content).trigger("change");wp.customize.instance(control.id).set(content)})}}});wp.customize.controlConstructor["xirki-multicheck"]=wp.customize.xirkiDynamicControl.extend({initXirkiControl:function(){var control=this;control.container.on("change","input",function(){var value=[],i=0;jQuery.each(control.params.choices,function(key){if(control.container.find('input[value="'+key+'"]').is(":checked")){control.container.find('input[value="'+key+'"]').parent().addClass("checked");value[i]=key;i++}else{control.container.find('input[value="'+key+'"]').parent().removeClass("checked")}});control.setting.set(value)})}});wp.customize.controlConstructor["xirki-multicolor"]=wp.customize.Control.extend({ready:function(){"use strict";var control=this;if(!_.isUndefined(window.xirkiControlLoader)&&_.isFunction(xirkiControlLoader)){xirkiControlLoader(control)}else{control.initXirkiControl()}},initXirkiControl:function(){"use strict";var control=this,colors=control.params.choices,keys=Object.keys(colors),value=this.params.value,i=0;function xirkiMulticolorChangeHandler(control,value,subSetting){var picker=control.container.find(".multicolor-index-"+subSetting),args={change:function(){setTimeout(function(){control.saveValue(subSetting,picker.val());control.container.find(".multicolor-index-"+subSetting).trigger("change")},100)}};if(_.isObject(colors.irisArgs)){_.each(colors.irisArgs,function(irisValue,irisKey){args[irisKey]=irisValue})}picker.wpColorPicker(args)}while(i<Object.keys(colors).length){xirkiMulticolorChangeHandler(this,value,keys[i]);i++}},saveValue:function(property,value){var control=this,input=control.container.find(".multicolor-hidden-value"),val=control.setting._value;val[property]=value;jQuery(input).attr("value",JSON.stringify(val)).trigger("change");control.setting.set(val)}});wp.customize.controlConstructor["xirki-palette"]=wp.customize.xirkiDynamicControl.extend({});wp.customize.controlConstructor["xirki-radio-buttonset"]=wp.customize.xirkiDynamicControl.extend({});wp.customize.controlConstructor["xirki-radio-image"]=wp.customize.xirkiDynamicControl.extend({});var RepeaterRow=function(rowIndex,container,label,control){"use strict";var self=this;this.rowIndex=rowIndex;this.container=container;this.label=label;this.header=this.container.find(".repeater-row-header");this.header.on("click",function(){self.toggleMinimize()});this.container.on("click",".repeater-row-remove",function(){self.remove()});this.header.on("mousedown",function(){self.container.trigger("row:start-dragging")});this.container.on("keyup change","input, select, textarea",function(e){self.container.trigger("row:update",[self.rowIndex,jQuery(e.target).data("field"),e.target])});this.setRowIndex=function(rowIndex){this.rowIndex=rowIndex;this.container.attr("data-row",rowIndex);this.container.data("row",rowIndex);this.updateLabel()};this.toggleMinimize=function(){this.container.toggleClass("minimized");this.header.find(".dashicons").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down")};this.remove=function(){this.container.slideUp(300,function(){jQuery(this).detach()});this.container.trigger("row:remove",[this.rowIndex])};this.updateLabel=function(){var rowLabelField,rowLabel,rowLabelSelector;if("field"===this.label.type){rowLabelField=this.container.find('.repeater-field [data-field="'+this.label.field+'"]');if(_.isFunction(rowLabelField.val)){rowLabel=rowLabelField.val();if(""!==rowLabel){if(!_.isUndefined(control.params.fields[this.label.field])){if(!_.isUndefined(control.params.fields[this.label.field].type)){if("select"===control.params.fields[this.label.field].type){if(!_.isUndefined(control.params.fields[this.label.field].choices)&&!_.isUndefined(control.params.fields[this.label.field].choices[rowLabelField.val()])){rowLabel=control.params.fields[this.label.field].choices[rowLabelField.val()]}}else if("radio"===control.params.fields[this.label.field].type||"radio-image"===control.params.fields[this.label.field].type){rowLabelSelector=control.selector+' [data-row="'+this.rowIndex+'"] .repeater-field [data-field="'+this.label.field+'"]:checked';rowLabel=jQuery(rowLabelSelector).val()}}}this.header.find(".repeater-row-label").text(rowLabel);return}}}this.header.find(".repeater-row-label").text(this.label.value+" "+(this.rowIndex+1))};this.updateLabel()};wp.customize.controlConstructor.repeater=wp.customize.Control.extend({ready:function(){"use strict";var control=this;if(!_.isUndefined(window.xirkiControlLoader)&&_.isFunction(xirkiControlLoader)){xirkiControlLoader(control)}else{control.initXirkiControl()}},initXirkiControl:function(){"use strict";var control=this,limit,theNewRow;var settingValue=this.params.value;this.settingField=this.container.find("[data-customize-setting-link]").first();this.setValue([],false);this.repeaterFieldsContainer=this.container.find(".repeater-fields").first();this.currentIndex=0;this.rows=[];limit=false;if(!_.isUndefined(this.params.choices.limit)){limit=0>=this.params.choices.limit?false:parseInt(this.params.choices.limit,10)}this.container.on("click","button.repeater-add",function(e){e.preventDefault();if(!limit||control.currentIndex<limit){theNewRow=control.addRow();theNewRow.toggleMinimize();control.initColorPicker();control.initSelect(theNewRow)}else{jQuery(control.selector+" .limit").addClass("highlight")}});this.container.on("click",".repeater-row-remove",function(){control.currentIndex--;if(!limit||control.currentIndex<limit){jQuery(control.selector+" .limit").removeClass("highlight")}});this.container.on("click keypress",".repeater-field-image .upload-button,.repeater-field-cropped_image .upload-button,.repeater-field-upload .upload-button",function(e){e.preventDefault();control.$thisButton=jQuery(this);control.openFrame(e)});this.container.on("click keypress",".repeater-field-image .remove-button,.repeater-field-cropped_image .remove-button",function(e){e.preventDefault();control.$thisButton=jQuery(this);control.removeImage(e)});this.container.on("click keypress",".repeater-field-upload .remove-button",function(e){e.preventDefault();control.$thisButton=jQuery(this);control.removeFile(e)});this.repeaterTemplate=_.memoize(function(){var compiled,options={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return function(data){compiled=_.template(control.container.find(".customize-control-repeater-content").first().html(),null,options);return compiled(data)}});if(settingValue.length){_.each(settingValue,function(subValue){theNewRow=control.addRow(subValue);control.initColorPicker();control.initSelect(theNewRow,subValue)})}this.setValue(settingValue,true,true);this.repeaterFieldsContainer.sortable({handle:".repeater-row-header",update:function(){control.sort()}})},openFrame:function(event){"use strict";if(wp.customize.utils.isKeydownButNotEnterEvent(event)){return}if(this.$thisButton.closest(".repeater-field").hasClass("repeater-field-cropped_image")){this.initCropperFrame()}else{this.initFrame()}this.frame.open()},initFrame:function(){"use strict";var libMediaType=this.getMimeType();this.frame=wp.media({states:[new wp.media.controller.Library({library:wp.media.query({type:libMediaType}),multiple:false,date:false})]});this.frame.on("select",this.onSelect,this)},initCropperFrame:function(){"use strict";var currentFieldId=this.$thisButton.siblings("input.hidden-field").attr("data-field"),attrs=["width","height","flex_width","flex_height"],libMediaType=this.getMimeType();if(_.isString(currentFieldId)&&""!==currentFieldId){if(_.isObject(this.params.fields[currentFieldId])&&"cropped_image"===this.params.fields[currentFieldId].type){attrs.forEach(function(el){if(!_.isUndefined(this.params.fields[currentFieldId][el])){this.params[el]=this.params.fields[currentFieldId][el]}}.bind(this))}}this.frame=wp.media({button:{text:"Select and Crop",close:false},states:[new wp.media.controller.Library({library:wp.media.query({type:libMediaType}),multiple:false,date:false,suggestedWidth:this.params.width,suggestedHeight:this.params.height}),new wp.media.controller.CustomizeImageCropper({imgSelectOptions:this.calculateImageSelectOptions,control:this})]});this.frame.on("select",this.onSelectForCrop,this);this.frame.on("cropped",this.onCropped,this);this.frame.on("skippedcrop",this.onSkippedCrop,this)},onSelect:function(){"use strict";var attachment=this.frame.state().get("selection").first().toJSON();if(this.$thisButton.closest(".repeater-field").hasClass("repeater-field-upload")){this.setFileInRepeaterField(attachment)}else{this.setImageInRepeaterField(attachment)}},onSelectForCrop:function(){"use strict";var attachment=this.frame.state().get("selection").first().toJSON();if(this.params.width===attachment.width&&this.params.height===attachment.height&&!this.params.flex_width&&!this.params.flex_height){this.setImageInRepeaterField(attachment)}else{this.frame.setState("cropper")}},onCropped:function(croppedImage){"use strict";this.setImageInRepeaterField(croppedImage)},calculateImageSelectOptions:function(attachment,controller){"use strict";var control=controller.get("control"),flexWidth=!!parseInt(control.params.flex_width,10),flexHeight=!!parseInt(control.params.flex_height,10),realWidth=attachment.get("width"),realHeight=attachment.get("height"),xInit=parseInt(control.params.width,10),yInit=parseInt(control.params.height,10),ratio=xInit/yInit,xImg=realWidth,yImg=realHeight,x1,y1,imgSelectOptions;controller.set("canSkipCrop",!control.mustBeCropped(flexWidth,flexHeight,xInit,yInit,realWidth,realHeight));if(xImg/yImg>ratio){yInit=yImg;xInit=yInit*ratio}else{xInit=xImg;yInit=xInit/ratio}x1=(xImg-xInit)/2;y1=(yImg-yInit)/2;imgSelectOptions={handles:true,keys:true,instance:true,persistent:true,imageWidth:realWidth,imageHeight:realHeight,x1:x1,y1:y1,x2:xInit+x1,y2:yInit+y1};if(false===flexHeight&&false===flexWidth){imgSelectOptions.aspectRatio=xInit+":"+yInit}if(false===flexHeight){imgSelectOptions.maxHeight=yInit}if(false===flexWidth){imgSelectOptions.maxWidth=xInit}return imgSelectOptions},mustBeCropped:function(flexW,flexH,dstW,dstH,imgW,imgH){"use strict";if(true===flexW&&true===flexH||true===flexW&&dstH===imgH||true===flexH&&dstW===imgW||dstW===imgW&&dstH===imgH||imgW<=dstW){return false}return true},onSkippedCrop:function(){"use strict";var attachment=this.frame.state().get("selection").first().toJSON();this.setImageInRepeaterField(attachment)},setImageInRepeaterField:function(attachment){"use strict";var $targetDiv=this.$thisButton.closest(".repeater-field-image,.repeater-field-cropped_image");$targetDiv.find(".xirki-image-attachment").html('<img src="'+attachment.url+'">').hide().slideDown("slow");$targetDiv.find(".hidden-field").val(attachment.id);this.$thisButton.text(this.$thisButton.data("alt-label"));$targetDiv.find(".remove-button").show();$targetDiv.find("input, textarea, select").trigger("change");this.frame.close()},setFileInRepeaterField:function(attachment){"use strict";var $targetDiv=this.$thisButton.closest(".repeater-field-upload");$targetDiv.find(".xirki-file-attachment").html('<span class="file"><span class="dashicons dashicons-media-default"></span> '+attachment.filename+"</span>").hide().slideDown("slow");$targetDiv.find(".hidden-field").val(attachment.id);this.$thisButton.text(this.$thisButton.data("alt-label"));$targetDiv.find(".upload-button").show();$targetDiv.find(".remove-button").show();$targetDiv.find("input, textarea, select").trigger("change");this.frame.close()},getMimeType:function(){"use strict";var currentFieldId=this.$thisButton.siblings("input.hidden-field").attr("data-field");if(_.isString(currentFieldId)&&""!==currentFieldId){if(_.isObject(this.params.fields[currentFieldId])&&"upload"===this.params.fields[currentFieldId].type){if(!_.isUndefined(this.params.fields[currentFieldId].mime_type)){return this.params.fields[currentFieldId].mime_type}}}return"image"},removeImage:function(event){"use strict";var $targetDiv,$uploadButton;if(wp.customize.utils.isKeydownButNotEnterEvent(event)){return}$targetDiv=this.$thisButton.closest(".repeater-field-image,.repeater-field-cropped_image,.repeater-field-upload");$uploadButton=$targetDiv.find(".upload-button");$targetDiv.find(".xirki-image-attachment").slideUp("fast",function(){jQuery(this).show().html(jQuery(this).data("placeholder"))});$targetDiv.find(".hidden-field").val("");$uploadButton.text($uploadButton.data("label"));this.$thisButton.hide();$targetDiv.find("input, textarea, select").trigger("change")},removeFile:function(event){"use strict";var $targetDiv,$uploadButton;if(wp.customize.utils.isKeydownButNotEnterEvent(event)){return}$targetDiv=this.$thisButton.closest(".repeater-field-upload");$uploadButton=$targetDiv.find(".upload-button");$targetDiv.find(".xirki-file-attachment").slideUp("fast",function(){jQuery(this).show().html(jQuery(this).data("placeholder"))});$targetDiv.find(".hidden-field").val("");$uploadButton.text($uploadButton.data("label"));this.$thisButton.hide();$targetDiv.find("input, textarea, select").trigger("change")},getValue:function(){"use strict";return JSON.parse(decodeURI(this.setting.get()))},setValue:function(newValue,refresh,filtering){"use strict";var filteredValue=newValue,filter=[];if(filtering){jQuery.each(this.params.fields,function(index,value){if("image"===value.type||"cropped_image"===value.type||"upload"===value.type){filter.push(index)}});jQuery.each(newValue,function(index,value){jQuery.each(filter,function(ind,field){if(!_.isUndefined(value[field])&&!_.isUndefined(value[field].id)){filteredValue[index][field]=value[field].id}})})}this.setting.set(encodeURI(JSON.stringify(filteredValue)));if(refresh){this.settingField.trigger("change")}},addRow:function(data){"use strict";var control=this,template=control.repeaterTemplate(),settingValue=this.getValue(),newRowSetting={},templateData,newRow,i;if(template){templateData=jQuery.extend(true,{},control.params.fields);if(data){for(i in data){if(data.hasOwnProperty(i)&&templateData.hasOwnProperty(i)){templateData[i].default=data[i]}}}templateData.index=this.currentIndex;template=template(templateData);newRow=new RepeaterRow(control.currentIndex,jQuery(template).appendTo(control.repeaterFieldsContainer),control.params.row_label,control);newRow.container.on("row:remove",function(e,rowIndex){control.deleteRow(rowIndex)});newRow.container.on("row:update",function(e,rowIndex,fieldName,element){control.updateField.call(control,e,rowIndex,fieldName,element);newRow.updateLabel()});this.rows[this.currentIndex]=newRow;for(i in templateData){if(templateData.hasOwnProperty(i)){newRowSetting[i]=templateData[i].default}}settingValue[this.currentIndex]=newRowSetting;this.setValue(settingValue,true);this.currentIndex++;return newRow}},sort:function(){"use strict";var control=this,$rows=this.repeaterFieldsContainer.find(".repeater-row"),newOrder=[],settings=control.getValue(),newRows=[],newSettings=[];$rows.each(function(i,element){newOrder.push(jQuery(element).data("row"))});jQuery.each(newOrder,function(newPosition,oldPosition){newRows[newPosition]=control.rows[oldPosition];newRows[newPosition].setRowIndex(newPosition);newSettings[newPosition]=settings[oldPosition]});control.rows=newRows;control.setValue(newSettings)},deleteRow:function(index){"use strict";var currentSettings=this.getValue(),row,i,prop;if(currentSettings[index]){row=this.rows[index];if(row){delete currentSettings[index];delete this.rows[index];this.setValue(currentSettings,true)}}i=1;for(prop in this.rows){if(this.rows.hasOwnProperty(prop)&&this.rows[prop]){this.rows[prop].updateLabel();i++}}},updateField:function(e,rowIndex,fieldId,element){"use strict";var type,row,currentSettings;if(!this.rows[rowIndex]){return}if(!this.params.fields[fieldId]){return}type=this.params.fields[fieldId].type;row=this.rows[rowIndex];currentSettings=this.getValue();element=jQuery(element);if(_.isUndefined(currentSettings[row.rowIndex][fieldId])){return}if("checkbox"===type){currentSettings[row.rowIndex][fieldId]=element.is(":checked")}else{currentSettings[row.rowIndex][fieldId]=element.val()}this.setValue(currentSettings,true)},initColorPicker:function(){"use strict";var control=this,colorPicker=control.container.find(".color-picker-hex"),options={},fieldId=colorPicker.data("field");if(!_.isUndefined(fieldId)&&!_.isUndefined(control.params.fields[fieldId])&&!_.isUndefined(control.params.fields[fieldId].palettes)&&_.isObject(control.params.fields[fieldId].palettes)){options.palettes=control.params.fields[fieldId].palettes}options.change=function(event,ui){var currentPicker=jQuery(event.target),row=currentPicker.closest(".repeater-row"),rowIndex=row.data("row"),currentSettings=control.getValue();currentSettings[rowIndex][currentPicker.data("field")]=ui.color.toString();control.setValue(currentSettings,true)};if(0!==colorPicker.length){colorPicker.wpColorPicker(options)}},initSelect:function(theNewRow,data){"use strict";var control=this,dropdown=theNewRow.container.find(".repeater-field select"),$select,dataField,multiple,selectWooOptions={};if(0===dropdown.length){return}dataField=dropdown.data("field");multiple=jQuery(dropdown).data("multiple");if("undefed"!==multiple&&jQuery.isNumeric(multiple)){multiple=parseInt(multiple,10);if(1<multiple){selectWooOptions.maximumSelectionLength=multiple}}data=data||{};data[dataField]=data[dataField]||"";$select=jQuery(dropdown).selectWoo(selectWooOptions).val(data[dataField]||jQuery(dropdown).val());this.container.on("change",".repeater-field select",function(event){var currentDropdown=jQuery(event.target),row=currentDropdown.closest(".repeater-row"),rowIndex=row.data("row"),currentSettings=control.getValue();currentSettings[rowIndex][currentDropdown.data("field")]=jQuery(this).val();control.setValue(currentSettings)})}});wp.customize.controlConstructor["xirki-slider"]=wp.customize.xirkiDynamicControl.extend({initXirkiControl:function(){var control=this,changeAction="postMessage"===control.setting.transport?"mousemove change":"change",rangeInput=control.container.find('input[type="range"]'),textInput=control.container.find('input[type="text"]'),value=control.setting._value;textInput.attr("value",value);rangeInput.on("mousemove change",function(){textInput.attr("value",rangeInput.val())});rangeInput.on(changeAction,function(){control.setting.set(rangeInput.val())});textInput.on("input paste change",function(){rangeInput.attr("value",textInput.val());control.setting.set(textInput.val())});control.container.find(".slider-reset").on("click",function(){textInput.attr("value",control.params.default);rangeInput.attr("value",control.params.default);control.setting.set(textInput.val())})}});wp.customize.controlConstructor["xirki-sortable"]=wp.customize.Control.extend({ready:function(){"use strict";var control=this;jQuery(control.container.find("ul.sortable").first()).sortable({update:function(){control.setting.set(control.getNewVal())}}).disableSelection().find("li").each(function(){jQuery(this).find("i.visibility").click(function(){jQuery(this).toggleClass("dashicons-visibility-faint").parents("li:eq(0)").toggleClass("invisible")})}).click(function(){control.setting.set(control.getNewVal())})},getNewVal:function(){var items=jQuery(this.container.find("li")),newVal=[];_.each(items,function(item){if(!jQuery(item).hasClass("invisible")){newVal.push(jQuery(item).data("value"))}});return newVal}});wp.customize.controlConstructor["xirki-switch"]=wp.customize.xirkiDynamicControl.extend({initXirkiControl:function(){"use strict";var control=this,checkboxValue=control.setting._value;this.container.on("change","input",function(){checkboxValue=jQuery(this).is(":checked")?true:false;control.setting.set(checkboxValue)})}});wp.customize.controlConstructor["xirki-toggle"]=wp.customize.xirkiDynamicControl.extend({initXirkiControl:function(){var control=this,checkboxValue=control.setting._value;this.container.on("change","input",function(){checkboxValue=jQuery(this).is(":checked")?true:false;control.setting.set(checkboxValue)})}});wp.customize.controlConstructor["xirki-typography"]=wp.customize.xirkiDynamicControl.extend({initXirkiControl:function(){"use strict";var control=this,value=control.setting._value,picker;control.renderFontSelector();control.renderBackupFontSelector();control.renderVariantSelector();if("undefined"!==typeof control.params.default["font-size"]){this.container.on("change keyup paste",".font-size input",function(){control.saveValue("font-size",jQuery(this).val())})}if("undefined"!==typeof control.params.default["line-height"]){this.container.on("change keyup paste",".line-height input",function(){control.saveValue("line-height",jQuery(this).val())})}if("undefined"!==typeof control.params.default["margin-top"]){this.container.on("change keyup paste",".margin-top input",function(){control.saveValue("margin-top",jQuery(this).val())})}if("undefined"!==typeof control.params.default["margin-bottom"]){this.container.on("change keyup paste",".margin-bottom input",function(){control.saveValue("margin-bottom",jQuery(this).val())})}if("undefined"!==typeof control.params.default["letter-spacing"]){value["letter-spacing"]=jQuery.isNumeric(value["letter-spacing"])?value["letter-spacing"]+"px":value["letter-spacing"];this.container.on("change keyup paste",".letter-spacing input",function(){value["letter-spacing"]=jQuery.isNumeric(jQuery(this).val())?jQuery(this).val()+"px":jQuery(this).val();control.saveValue("letter-spacing",value["letter-spacing"])})}if("undefined"!==typeof control.params.default["word-spacing"]){this.container.on("change keyup paste",".word-spacing input",function(){control.saveValue("word-spacing",jQuery(this).val())})}if("undefined"!==typeof control.params.default["text-align"]){this.container.on("change",".text-align input",function(){control.saveValue("text-align",jQuery(this).val())})}if("undefined"!==typeof control.params.default["text-transform"]){jQuery(control.selector+" .text-transform select").selectWoo().on("change",function(){control.saveValue("text-transform",jQuery(this).val())})}if("undefined"!==typeof control.params.default["text-decoration"]){jQuery(control.selector+" .text-decoration select").selectWoo().on("change",function(){control.saveValue("text-decoration",jQuery(this).val())})}if("undefined"!==typeof control.params.default.color){picker=this.container.find(".xirki-color-control");picker.wpColorPicker({change:function(){setTimeout(function(){control.saveValue("color",picker.val())},100)},clear:function(event){setTimeout(function(){control.saveValue("color","")},100)}})}},renderFontSelector:function(){var control=this,selector=control.selector+" .font-family select",data=[],standardFonts=[],googleFonts=[],value=control.setting._value,fonts=control.getFonts(),fontSelect,controlFontFamilies;if(!_.isUndefined(fonts.standard)){_.each(fonts.standard,function(font){standardFonts.push({id:font.family.replace(/&quot;/g,"&#39"),text:font.label})})}if(!_.isUndefined(fonts.google)){_.each(fonts.google,function(font){googleFonts.push({id:font.family,text:font.family})})}controlFontFamilies={};if(!_.isUndefined(control.params)&&!_.isUndefined(control.params.choices)&&!_.isUndefined(control.params.choices.fonts)&&!_.isUndefined(control.params.choices.fonts.families)){controlFontFamilies=control.params.choices.fonts.families}data=jQuery.extend({},controlFontFamilies,{default:{text:xirkiL10n.defaultCSSValues,children:[{id:"",text:xirkiL10n.defaultBrowserFamily},{id:"initial",text:"initial"},{id:"inherit",text:"inherit"}]},standard:{text:xirkiL10n.standardFonts,children:standardFonts},google:{text:xirkiL10n.googleFonts,children:googleFonts}});if(xirkiL10n.isScriptDebug){console.info('Xirki Debug: Font families for control "'+control.id+'":');console.info(data)}data=_.values(data);fontSelect=jQuery(selector).selectWoo({data:data});if(value["font-family"]||""===value["font-family"]){value["font-family"]=xirki.util.parseHtmlEntities(value["font-family"].replace(/'/g,'"'));fontSelect.val(value["font-family"]).trigger("change")}fontSelect.on("change",function(){control.saveValue("font-family",jQuery(this).val());control.renderBackupFontSelector();control.renderVariantSelector()})},renderBackupFontSelector:function(){var control=this,selector=control.selector+" .font-backup select",standardFonts=[],value=control.setting._value,fontFamily=value["font-family"],fonts=control.getFonts(),fontSelect;if(_.isUndefined(value["font-backup"])||null===value["font-backup"]){value["font-backup"]=""}if("inherit"===fontFamily||"initial"===fontFamily||"google"!==xirki.util.webfonts.getFontType(fontFamily)){jQuery(control.selector+" .font-backup").hide();return}jQuery(control.selector+" .font-backup").show();if(!_.isUndefined(fonts.standard)){_.each(fonts.standard,function(font){standardFonts.push({id:font.family.replace(/&quot;/g,"&#39"),text:font.label})})}fontSelect=jQuery(selector).selectWoo({data:standardFonts});if("undefined"!==typeof value["font-backup"]){fontSelect.val(value["font-backup"].replace(/'/g,'"')).trigger("change")}fontSelect.on("change",function(){control.saveValue("font-backup",jQuery(this).val())})},renderVariantSelector:function(){var control=this,value=control.setting._value,fontFamily=value["font-family"],selector=control.selector+" .variant select",data=[],isValid=false,fontType=xirki.util.webfonts.getFontType(fontFamily),variants=["","regular","italic","700","700italic"],fontWeight,variantSelector,fontStyle;if("google"===fontType){variants=xirki.util.webfonts.google.getVariants(fontFamily)}if(!_.isUndefined(control.params)&&!_.isUndefined(control.params.choices)&&!_.isUndefined(control.params.choices.fonts)&&!_.isUndefined(control.params.choices.fonts.variants)){if(!_.isUndefined(control.params.choices.fonts.variants[fontFamily])){variants=control.params.choices.fonts.variants[fontFamily]}}if(xirkiL10n.isScriptDebug){console.info('Xirki Debug: Font variants for font-family "'+fontFamily+'":');console.info(variants)}if("inherit"===fontFamily||"initial"===fontFamily||""===fontFamily){value.variant="inherit";variants=[""];jQuery(control.selector+" .variant").hide()}if(1>=variants.length){jQuery(control.selector+" .variant").hide();value.variant=variants[0];control.saveValue("variant",value.variant);if(""===value.variant||!value.variant){fontWeight="";fontStyle=""}else{fontWeight=!_.isString(value.variant)?"400":value.variant.match(/\d/g);fontWeight=!_.isObject(fontWeight)?"400":fontWeight.join("");fontStyle=value.variant&&-1!==value.variant.indexOf("italic")?"italic":"normal"}control.saveValue("font-weight",fontWeight);control.saveValue("font-style",fontStyle);return}jQuery(control.selector+" .font-backup").show();jQuery(control.selector+" .variant").show();_.each(variants,function(variant){if(value.variant===variant){isValid=true}data.push({id:variant,text:variant})});if(!isValid){value.variant="regular"}if(jQuery(selector).hasClass("select2-hidden-accessible")){jQuery(selector).selectWoo("destroy");jQuery(selector).empty()}variantSelector=jQuery(selector).selectWoo({data:data});variantSelector.val(value.variant).trigger("change");variantSelector.on("change",function(){control.saveValue("variant",jQuery(this).val());if("string"!==typeof value.variant){value.variant=variants[0]}fontWeight=!_.isString(value.variant)?"400":value.variant.match(/\d/g);fontWeight=!_.isObject(fontWeight)?"400":fontWeight.join("");fontStyle=-1!==value.variant.indexOf("italic")?"italic":"normal";control.saveValue("font-weight",fontWeight);control.saveValue("font-style",fontStyle)})},getFonts:function(){var control=this,initialGoogleFonts=xirki.util.webfonts.google.getFonts(),googleFonts={},googleFontsSort="alpha",googleFontsNumber=0,standardFonts={};if(!_.isEmpty(control.params.choices.fonts.google)){if("alpha"===control.params.choices.fonts.google[0]||"popularity"===control.params.choices.fonts.google[0]||"trending"===control.params.choices.fonts.google[0]){googleFontsSort=control.params.choices.fonts.google[0];if(!isNaN(control.params.choices.fonts.google[1])){googleFontsNumber=parseInt(control.params.choices.fonts.google[1],10)}googleFonts=xirki.util.webfonts.google.getFonts(googleFontsSort,"",googleFontsNumber)}else{_.each(control.params.choices.fonts.google,function(fontName){if("undefined"!==typeof initialGoogleFonts[fontName]&&!_.isEmpty(initialGoogleFonts[fontName])){googleFonts[fontName]=initialGoogleFonts[fontName]}})}}else{googleFonts=xirki.util.webfonts.google.getFonts(googleFontsSort,"",googleFontsNumber)}if(!_.isEmpty(control.params.choices.fonts.standard)){_.each(control.params.choices.fonts.standard,function(fontName){if("undefined"!==typeof xirki.util.webfonts.standard.fonts[fontName]&&!_.isEmpty(xirki.util.webfonts.standard.fonts[fontName])){standardFonts[fontName]={};if("undefined"!==xirki.util.webfonts.standard.fonts[fontName].stack&&!_.isEmpty(xirki.util.webfonts.standard.fonts[fontName].stack)){standardFonts[fontName].family=xirki.util.webfonts.standard.fonts[fontName].stack}else{standardFonts[fontName].family=googleFonts[fontName]}if("undefined"!==xirki.util.webfonts.standard.fonts[fontName].label&&!_.isEmpty(xirki.util.webfonts.standard.fonts[fontName].label)){standardFonts[fontName].label=xirki.util.webfonts.standard.fonts[fontName].label}else if(!_.isEmpty(standardFonts[fontName])){standardFonts[fontName].label=standardFonts[fontName]}}else{standardFonts[fontName]={family:fontName,label:fontName}}})}else{_.each(xirki.util.webfonts.standard.fonts,function(font,id){standardFonts[id]={family:font.stack,label:font.label}})}return{google:googleFonts,standard:standardFonts}},saveValue:function(property,value){var control=this,input=control.container.find(".typography-hidden-value"),val=control.setting._value;val[property]=value;jQuery(input).attr("value",JSON.stringify(val)).trigger("change");control.setting.set(val)}});